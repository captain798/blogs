---
title: 微信小程序开发大经验总结大杂烩
date: 2025-06-30
categories:
  - 微信小程序
tags:

sticky: 1
---

## 摘要
1. 本文总结了微信小程序开发中的关键经验和技巧
2. 包含实用的开发模式和最佳实践
3. 涵盖了从项目搭建到发布上线的完整流程

<!-- more -->

# 微信小程序开发历程

## 1.Skyline渲染引擎问题解决方案（模拟器可以显示图片，真机却不显示）

### 问题现象
- **不使用Skyline时**：真机调试下某些页面的图片无法显示
- **使用Skyline时**：真机调试下其他页面样式混乱
- **模拟器环境**：无论是否使用Skyline，样式均正常

### 原因分析
Skyline渲染引擎虽然能提升性能，但会导致部分样式渲染不一致问题

### 解决方案
1.采用**按页面粒度开启Skyline**的混合方案：

```json
  1.全局配置 (app.json)
{
  "lazyCodeLoading": "requiredComponents",
  "rendererOptions": {
  "skyline": {
    "defaultDisplayBlock": true,
    "disableABTest": true,
    "sdkVersionBegin": "3.0.0", 
    "sdkVersionEnd": "15.255.255"
  }
  }
}

  2.页面级配置 (index.json)
{
  "componentFramework": "glass-easel",
  "renderer": "skyline" 
}
```
2.直接**删除Skyline渲染引擎的相关配置**，使用默认渲染引擎


## 2.function（event）

event 对象的常见属性（微信小程序）：

| 属性 | 说明 |
|------|------|
| event.type | 事件类型（如 tap, input, change 等）|
| event.timeStamp | 事件触发的时间戳 |
| event.target | 触发事件的组件信息（如按钮的 id、dataset 等）|
| event.currentTarget | 当前处理事件的组件信息（类似 target）|
| event.detail | 额外信息（不同事件不同内容，如输入框的 value）|


## 3.wx.navigateTo() 与 wx.switchTab() 的区别

### wx.navigateTo()
- 保留当前页面，跳转到非tabBar页面
- 页面栈最多十层
- 适用于普通页面间的跳转

### wx.switchTab()
- 跳转到tabBar页面，并关闭其他所有非tabBar页面
- 只能用于tabBar页面间的切换
- 不能传参
- 会重置页面栈

### 使用场景
- 普通页面跳转：使用navigateTo
- 底部tab切换：使用switchTab
- 需要清空页面栈：使用switchTab或reLaunch

### 注意事项
- 如果页面被定义进了tabBar，则只能采用wx.switchTab()

## 4.自定义tabBar

需求：为不同角色提供不同的  tabBar

### 步骤

 - 1.在app.json中的tabBar项设置custom字段，并且为true，同时其余tabBar设计的页面也要配置
 - 2.编写tabBar自定义组件，组件**文件夹必须放在根目录下**，并且**必须命名为custom-tab-bar**
 - 3.在attached生命周期中设置tabBar中的tab列表数据（注：attached在组件初始化后触发）
 - 4.在每个页面的onShow方法中设置tab选中状态
```json
this.getTabBar.setData({
  selected:0
})
```
- 5.pagePath和image的路径前面都要加**前导斜杠**，不然就会识别为相对路径

## 5.真机模拟如何本地测试（与后端flask对接）

### 测试步骤：
- 配置微信小程序开发工具：
  - 开启「开发环境不校验请求域名及TLS版本」（设置→项目配置）；
  - 填写后端本地IP（如`http://192.168.1.100:5000`，Windows可通过`ipconfig`查看本地IP）；
- 注意事项：
  - 后端需设置CORS（跨域资源共享），可通过`flask-cors`库快速配置；
  - 本地测试时确保手机与电脑在同一局域网，真机调试需使用电脑IP而非`localhost`~

## 6.微信code的获取

### 步骤：
- 1.在微信小程序后台配置合法域名，填入后端的域名(本地测试不用)
- 2.在前端调用wx.login()方法获取code
- 3.将code发送到后端，后端通过code获取openid和session_key
- 4.后端将openid和session_key返回给前端，前端保存到本地

## 7.自定义弹窗

### 步骤
- 创建文件夹 input-modal
- 创建四个文件：
  - input-modal.wxml (视图模板)
  - input-modal.wxss (样式文件)
  - input-modal.js (逻辑文件)
  - input-modal.json (配置文件)
- input-modal.json 配置：
```json
{
  "component": true
}
```

### 使用方法
1. 在页面json中声明组件：
```json
{
  "usingComponents": {
    "input-modal": "/components/input-modal/input-modal"
  }
}
```

2. 在页面wxml中使用：
```html
<input-modal show="{{showModal}}" bind:confirm="onConfirm" bind:cancel="onCancel"/>
```

3. 控制显示/隐藏：
```javascript
Page({
  data: {
    showModal: false
  },
  showModal() {
    this.setData({
      showModal: true
    })
  },
  onConfirm() {
    // 确认逻辑
  },
  onCancel() {
    // 取消逻辑
  }
})
```



## 8.json格式的数据获取


```javascript
updateTabbarList() {
            const role = getApp().globalData.userInfo?.user.role || 'student';  
            console.log('当前角色:', role);  // 调试日志
            this.setData({
                list: USER_PAGE[`${role}TabbarList`] || []  // 根据角色设置菜单
            });
        }
```

  主要错误：      
```javascript
const role = getApp().globalData.userInfo?.user.role || 'student'; //正确的

const role = getApp().globalData.userInfo?.role || 'student';  //错误的

对于json嵌套结构数据的获取一定要小心

```

## 9.npm赋能小程序开发
  
  npm可以很烦方便地下载微信小程序的包